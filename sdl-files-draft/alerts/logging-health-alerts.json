{
    description: "[Log Health] Less S1 EDR Event Types than expected",
    evaluationFrequencyMinutes: 60,
    gracePeriodMinutes: 0,
    renotifyPeriodMinutes: 60,
    resolutionDelayMinutes: 0,
    trigger: "tableRows:7 days(dataSource.name ='SentinelOne' | group EventTypeCount = estimate_distinct(event.type) by timebucket('1hour')| filter EventTypeCount < 40) > 1",
    note: "Looks for situations in which the number of unique EDR event types is lower than expected. If this fires, it indicates that there is something wrong with logging of EDR telemetry (Deep Visibility)"
  },
  {
    description: "[Log Health] Log Source logging below 10% of usual volume",
    evaluationFrequencyMinutes: 60,
    gracePeriodMinutes: 0,
    renotifyPeriodMinutes: 60,
    resolutionDelayMinutes: 0,
    trigger: "tableRows:2 hours(| join a = (tag = "logvolume.tracker" | columns dataSource.name, log.count, time.hour), b = (tag = 'logvolume.tracker' | group p50.logs=p50(log.count) by dataSource.name) on dataSource.name | let log.rate.ratio = (log.count / p50.logs) | filter log.rate.ratio < .10 | sort +log.rate.ratio ) > 1",
    note: "Looks for log sources (based on dataSource.name field) that are logging below their usual rate. Pre-requisites: must have set up the PowerQuery Monitors 'logvolume.tracker.json' and 'logvolume.tracker.p50json'"
  },




  